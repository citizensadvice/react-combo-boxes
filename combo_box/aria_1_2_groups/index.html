<html lang="en-GB"><head><meta charset="utf-8"><title>Combo box with ARIA 1.2 groups</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="/react-combo-boxes/styles.3de34798.css"><script src="https://polyfill.io/v3/polyfill.min.js?features=default%2Ces2018%2Ces2015%2Ces2016%2Ces2017%2Ces2019%2CNodeList.prototype.forEach" crossorigin="anonymous"></script></head><body><nav><div>React combo boxes</div><details><summary>Select</summary><a href="/react-combo-boxes/select.html">About</a><a href="/react-combo-boxes/select/string_options/index.html">String options</a><a href="/react-combo-boxes/select/object_options/index.html">Object options</a><a href="/react-combo-boxes/select/placeholder_option/index.html">Placeholder option</a><a href="/react-combo-boxes/select/disabled_option/index.html">Disabled option</a><a href="/react-combo-boxes/select/grouped_options/index.html">Grouped options</a><a href="/react-combo-boxes/select/mapped_options/index.html">Mapped options</a><a href="/react-combo-boxes/select/html_options/index.html">HTML options</a></details><details><summary>Drop down</summary><a href="/react-combo-boxes/drop_down.html">About</a><a href="/react-combo-boxes/drop_down/string_options/index.html">String options</a><a href="/react-combo-boxes/drop_down/object_options/index.html">Object options</a><a href="/react-combo-boxes/drop_down/placeholder_option/index.html">Placeholder option</a><a href="/react-combo-boxes/drop_down/disabled_option/index.html">Disabled option</a><a href="/react-combo-boxes/drop_down/disabled/index.html">Disabled drop down</a><a href="/react-combo-boxes/drop_down/grouped_options/index.html">Grouped options</a><a href="/react-combo-boxes/drop_down/html_options/index.html">HTML options</a><a href="/react-combo-boxes/drop_down/mapped_options/index.html">Mapped options</a><a href="/react-combo-boxes/drop_down/without_managed_focus/index.html">Without managed focus</a><a href="/react-combo-boxes/drop_down/aria_1_2_groups/index.html">With ARIA 1.2 groups</a><details><summary>Edge cases</summary><a href="/react-combo-boxes/drop_down/identical_options/index.html">Identical options</a><a href="/react-combo-boxes/drop_down/no_options/index.html">No options</a><a href="/react-combo-boxes/drop_down/all_disabled_options/index.html">All disabled options</a></details></details><details><summary>Combo box</summary><a href="/react-combo-boxes/combo_box.html">About</a><a href="/react-combo-boxes/combo_box/string_options/index.html">String options</a><a href="/react-combo-boxes/combo_box/object_options/index.html">Object options</a><a href="/react-combo-boxes/combo_box/disabled_option/index.html">Disabled option</a><a href="/react-combo-boxes/combo_box/grouped_options/index.html">Grouped options</a><a href="/react-combo-boxes/combo_box/html_options/index.html">HTML options</a><a href="/react-combo-boxes/combo_box/mapped_options/index.html">Mapped options</a><a href="/react-combo-boxes/combo_box/without_autocomplete/index.html">Without autocomplete</a><a href="/react-combo-boxes/combo_box/without_managed_focus/index.html">Without managed focus</a><a href="/react-combo-boxes/combo_box/inline_autocomplete/index.html">With inline autocomplete</a><a href="/react-combo-boxes/combo_box/aria_1_0/index.html">ARIA 1.0</a><a href="/react-combo-boxes/combo_box/aria_1_1/index.html">ARIA 1.1</a><a>ARIA 1.2 groups</a><a href="/react-combo-boxes/combo_box/listbox_footer/index.html">Listbox footer</a><details><summary>Searches</summary><a href="/react-combo-boxes/searchers.html">About</a><a href="/react-combo-boxes/combo_box/async_search/index.html">Async search</a><a href="/react-combo-boxes/combo_box/search_suggestions/index.html">Search suggestions</a><a href="/react-combo-boxes/combo_box/background_autocomplete/index.html">With background autocomplete</a></details><details><summary>Edge cases</summary><a href="/react-combo-boxes/combo_box/identical_options/index.html">Identical options</a><a href="/react-combo-boxes/combo_box/all_disabled_options/index.html">All disabled options</a><a href="/react-combo-boxes/combo_box/autoselect_disabled_option/index.html">Disabled option and autoselect</a><a href="/react-combo-boxes/combo_box/search_min_length/index.html">Search min length</a></details></details><details><summary>Table layout</summary><a href="/react-combo-boxes/list_box_table.html">About</a><details><summary>Drop down</summary><a href="/react-combo-boxes/list_box_table/drop_down/index.html">Table</a><a href="/react-combo-boxes/list_box_table/drop_down_headers/index.html">With headers</a><a href="/react-combo-boxes/list_box_table/drop_down_grouped/index.html">Grouped</a></details><details><summary>Combo box</summary><a href="/react-combo-boxes/list_box_table/combo_box/index.html">Table</a><a href="/react-combo-boxes/list_box_table/combo_box_headers/index.html">With headers</a><a href="/react-combo-boxes/list_box_table/combo_box_grouped/index.html">Grouped</a></details></details><a href="/react-combo-boxes/test_helper.html">Test helper</a></nav><script src="/react-combo-boxes/side_collapse.da5ebe24.js"></script><main><h1 id="combo-box-with-aria-12-groups">Combo box with ARIA 1.2 groups</h1>
<p>A combo box modified to use ARIA 1.2 groups. In the main implementation groups are simulated using text label,
and are not associated with the option. These are <em>true</em> groups and can be associated with an option by a compatible screen-reader.</p>
<p>The group role is only been allowed as a child of a list box in <a href="https://www.w3.org/TR/wai-aria-1.2/#substantive-changes-since-the-wai-aria-1-1-recommendation">ARIA 1.2</a>, which is still a working draft.</p>
<p>Therefore this is not compatible with the majority of screen readers and is only here as an example.</p>
<div data-react-example="combo_box/aria_1_2_groups"></div><pre class="language-js"><code class="language-js"><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> forwardRef<span class="token punctuation">,</span> useContext<span class="token punctuation">,</span> useState <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Context<span class="token punctuation">,</span> ComboBox<span class="token punctuation">,</span> useTokenSearch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@citizensadvice/react-combo-boxes'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> label<span class="token operator">:</span> <span class="token string">'Apple'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> label<span class="token operator">:</span> <span class="token string">'Orange'</span><span class="token punctuation">,</span> group<span class="token operator">:</span> <span class="token string">'Citrus'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> label<span class="token operator">:</span> <span class="token string">'Lemon'</span><span class="token punctuation">,</span> group<span class="token operator">:</span> <span class="token string">'Citrus'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> label<span class="token operator">:</span> <span class="token string">'Raspberry'</span><span class="token punctuation">,</span> group<span class="token operator">:</span> <span class="token string">'Berry'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> label<span class="token operator">:</span> <span class="token string">'Strawberry'</span><span class="token punctuation">,</span> group<span class="token operator">:</span> <span class="token string">'Berry'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">GroupComponent</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> group<span class="token operator">:</span> <span class="token punctuation">{</span> key <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>Context<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>label<span class="token punctuation">,</span> groupOptions<span class="token punctuation">]</span> <span class="token operator">=</span> children<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>li
      role<span class="token operator">=</span><span class="token string">"group"</span>
      aria<span class="token operator">-</span>labelledby<span class="token operator">=</span><span class="token punctuation">{</span>key<span class="token punctuation">}</span>
    <span class="token operator">></span>
      <span class="token punctuation">{</span>label<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>ul
        role<span class="token operator">=</span><span class="token string">"presentation"</span>
        className<span class="token operator">=</span><span class="token string">"react-combo-boxes-listbox__group"</span>
      <span class="token operator">></span>
        <span class="token punctuation">{</span>groupOptions<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">GroupLabelComponent</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> group<span class="token operator">:</span> <span class="token punctuation">{</span> key <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>Context<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div
      className<span class="token operator">=</span><span class="token string">"react-combo-boxes-listbox__group-label"</span>
      id<span class="token operator">=</span><span class="token punctuation">{</span>key<span class="token punctuation">}</span>
    <span class="token operator">></span>
      <span class="token punctuation">{</span>children<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> OptionComponent <span class="token operator">=</span> <span class="token function">forwardRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children<span class="token punctuation">,</span> <span class="token operator">...</span>props <span class="token punctuation">}</span><span class="token punctuation">,</span> ref</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// Filter out visually hidden label</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span><span class="token punctuation">,</span> option<span class="token punctuation">]</span> <span class="token operator">=</span> children<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>li
      ref<span class="token operator">=</span><span class="token punctuation">{</span>ref<span class="token punctuation">}</span>
      <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span>
    <span class="token operator">></span>
      <span class="token punctuation">{</span>option<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">Example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>value<span class="token punctuation">,</span> setValue<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>managedFocus<span class="token punctuation">,</span> setManagedFocus<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>filteredOptions<span class="token punctuation">,</span> onSearch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useTokenSearch</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>label htmlFor<span class="token operator">=</span><span class="token string">"select"</span><span class="token operator">></span>
        Select
      <span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&lt;</span>ComboBox
        id<span class="token operator">=</span><span class="token string">"select"</span>
        value<span class="token operator">=</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span>
        onValue<span class="token operator">=</span><span class="token punctuation">{</span>setValue<span class="token punctuation">}</span>
        onSearch<span class="token operator">=</span><span class="token punctuation">{</span>onSearch<span class="token punctuation">}</span>
        options<span class="token operator">=</span><span class="token punctuation">{</span>filteredOptions<span class="token punctuation">}</span>
        managedFocus<span class="token operator">=</span><span class="token punctuation">{</span>managedFocus<span class="token punctuation">}</span>
        GroupComponent<span class="token operator">=</span><span class="token punctuation">{</span>GroupComponent<span class="token punctuation">}</span>
        GroupLabelComponent<span class="token operator">=</span><span class="token punctuation">{</span>GroupLabelComponent<span class="token punctuation">}</span>
        OptionComponent<span class="token operator">=</span><span class="token punctuation">{</span>OptionComponent<span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">></span>

      <span class="token operator">&lt;</span>label<span class="token operator">></span>
        <span class="token operator">&lt;</span>input
          type<span class="token operator">=</span><span class="token string">"checkbox"</span>
          onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> target<span class="token operator">:</span> <span class="token punctuation">{</span> checked <span class="token punctuation">}</span> <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">setManagedFocus</span><span class="token punctuation">(</span>checked<span class="token punctuation">)</span><span class="token punctuation">}</span>
          checked<span class="token operator">=</span><span class="token punctuation">{</span>managedFocus<span class="token punctuation">}</span>
        <span class="token operator">/</span><span class="token operator">></span>
        <span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">}</span>
        Toggle managed focus
      <span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span>

      <span class="token operator">&lt;</span>label htmlFor<span class="token operator">=</span><span class="token string">"output"</span><span class="token operator">></span>
        Current value
      <span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span>
      <span class="token operator">&lt;</span>output htmlFor<span class="token operator">=</span><span class="token string">"select"</span> id<span class="token operator">=</span><span class="token string">"output"</span><span class="token operator">></span>
        <span class="token punctuation">{</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>output<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></main><script src="/react-combo-boxes/render.25ac162b.js"></script></body></html>